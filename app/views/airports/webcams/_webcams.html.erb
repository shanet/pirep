<% image_webcams = @airport.webcams.select(&:image?) %>

<div class="card mt-3">
  <div class="card-header">
    <i class="fas fa-camera"></i> Airport <%= 'Webcam'.pluralize(@airport.webcams.count) %>
  </div>

  <ul class="list-group list-group-flush">
    <% @airport.webcams.reject(&:image?).each do |webcam| %>
      <li class="list-group-item"><%= link_to(webcam.url.truncate(50), webcam.url, class: 'webcam-link') %></li>
    <% end %>
  </ul>
</div>

<% if image_webcams.any? %>
  <%= render 'airports/webcams/webcam', webcam: image_webcams.first %>
<% end %>

<div class="text-end mt-2">
  <% if @airport.webcams.empty? %>
    <small class="text-body-secondary">No webcams added yet.</small>
  <% end %>

  <button type="button" class="btn btn-outline-primary btn-sm me-2" data-bs-toggle="collapse" data-bs-target="add-webcam-form">Add Webcam</a>

  <% if image_webcams.count > 1 %>
    <button id="show-more-webcams" class="btn btn-outline-primary btn-sm" data-bs-toggle="collapse" data-bs-target="show-all-webcams">Show More</a></button>
  <% end %>
</div>

<%= render 'airports/webcams/add_webcam_form' %>

<% content_for :collapsible_content, flush: true do %>
  <% if image_webcams.count > 1 %>
    <% image_webcams[1..].each do |webcam| %>
      <%= render 'airports/webcams/webcam', webcam: webcam %>
    <% end %>
  <% end %>
<% end %>

<%= render 'shared/collapsible', id: 'show-all-webcams', classes: 'mb-2' %>
